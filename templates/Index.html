<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poppin - Order Popcorn</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; background: #fff; color: #333; }
        h1 { color: #FFD700; } /* Brand color */
        form { margin-bottom: 20px; display: flex; flex-direction: column; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #FFD700; border-radius: 4px; }
        button { padding: 10px 20px; background: #FFD700; color: #333; border: none; cursor: pointer; border-radius: 4px; transition: background 0.3s; }
        button:hover { background: #FFC700; }
        #order-result, #status-result { margin-top: 20px; font-weight: bold; opacity: 0; transition: opacity 0.5s; }
        #order-result.show { opacity: 1; } /* Fade-in animation */
        canvas { position: fixed; top: 0; left: 0; pointer-events: none; } /* For confetti */
        footer { text-align: center; margin-top: 40px; font-size: 0.8em; color: #777; }
        @media (max-width: 600px) { body { padding: 10px; } }
    </style>
</head>
<body>
    <h1>Poppin - Order Your Favorite Popcorn</h1>
    <form id="order-form">
        <input type="text" id="name" placeholder="Your Name" required aria-label="Name">
        <input type="email" id="email" placeholder="Your Email" required aria-label="Email">
        <select id="popcorn_type" required aria-label="Popcorn Type">
            <option value="">Select Popcorn Type</option>
            <option value="Salted">Salted</option>
            <option value="Caramel">Caramel</option>
            <option value="Cheese">Cheese</option>
        </select>
        <input type="number" id="quantity" placeholder="Quantity" min="1" required aria-label="Quantity">
        <input type="text" id="address" placeholder="Delivery Address" required aria-label="Address">
        <button type="submit">Place Order with Poppin</button>
    </form>
    <div id="order-result"></div>

    <h2>Check Poppin Order Status</h2>
    <form id="status-form">
        <input type="number" id="order_id" placeholder="Order ID" required aria-label="Order ID">
        <button type="submit">Check Status</button>
    </form>
    <div id="status-result"></div>

    <canvas id="confetti-canvas"></canvas> <!-- For confetti effect -->

    <footer>&copy; 2026 Poppin Popcorn. Freshly popped in Pune!</footer>

    <script>
        // Handle order submission with animation and confetti
        document.getElementById('order-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                popcorn_type: document.getElementById('popcorn_type').value,
                quantity: document.getElementById('quantity').value,
                address: document.getElementById('address').value
            };
            const response = await fetch('/place_order', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            const orderResult = document.getElementById('order-result');
            orderResult.innerText = `Order placed! Your Poppin Order ID: ${result.order_id}. Status: ${result.status}`;
            orderResult.classList.add('show'); // Trigger fade-in
            triggerConfetti(); // Add confetti effect
        });

        // Handle status check
        document.getElementById('status-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = { order_id: document.getElementById('order_id').value };
            const response = await fetch('/check_status', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const statusResult = document.getElementById('status-result');
            if (response.ok) {
                const result = await response.json();
                statusResult.innerText = `Status: ${result.status}`;
            } else {
                const result = await response.json();
                statusResult.innerText = result.error;
            }
            statusResult.classList.add('show'); // Fade-in for status too
        });

        // Simple confetti function
        function triggerConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const ctx = canvas.getContext('2d');
            const pieces = [];
            for (let i = 0; i < 100; i++) {
                pieces.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    r: Math.random() * 4 + 1,
                    d: Math.random() * 100 + 50,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    tilt: Math.random() * 10 - 5,
                    tiltAngle: 0
                });
            }
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                pieces.forEach(p => {
                    p.tiltAngle += 0.1;
                    p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2;
                    p.x += Math.sin(p.d);
                    p.tilt = Math.sin(p.tiltAngle) * 15;
                    ctx.beginPath();
                    ctx.lineWidth = p.r;
                    ctx.strokeStyle = p.color;
                    ctx.moveTo(p.x + p.tilt + p.r / 4, p.y);
                    ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r / 4);
                    ctx.stroke();
                });
                if (pieces.every(p => p.y < canvas.height + 100)) requestAnimationFrame(draw);
                else canvas.style.display = 'none';
            }
            canvas.style.display = 'block';
            draw();
        }
    </script>
</body>
</html>